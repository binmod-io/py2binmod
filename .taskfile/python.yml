version: '3'

vars:
  PACKAGE_SRC_DIR: python/py2binmod

tasks:
  lint:
    cmds:
      - |
        if [ -n "{{.SRC_DIR}}" ]; then
          export SRC_DIR="{{.SRC_DIR}}"
        else
          export SRC_DIR="{{.PACKAGE_SRC_DIR}}"
        fi
      - uvx ruff check $SRC_DIR {{.CLI_ARGS}}
      - |
        if [ "{{.FORMAT}}" = "true" ]; then
          uvx ruff format $SRC_DIR {{.CLI_ARGS}}
        fi

  build:
    cmds:
      - maturin build {{.CLI_ARGS}}

  dev:
    cmds:
      - maturin develop {{.CLI_ARGS}}